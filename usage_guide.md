# 学生照片抽认卡系统 - 使用指南

## 🎯 主要改进

### 1. 用户交互增强
- ✅ 添加了明确的开始确认提示
- ✅ 改进了浏览器操作流程说明
- ✅ 支持中文确认提示

### 2. 下载修复
- ✅ 修复了空文件下载问题
- ✅ 添加了浏览器会话保持
- ✅ 增强了错误处理和文件验证
- ✅ 添加了详细的下载状态提示

## 📋 使用步骤

### 步骤1: 启动系统
```bash
python3 student_photo_scraper_enhanced.py
```

### 步骤2: 浏览器操作
1. 脚本会自动打开Chrome浏览器
2. 在浏览器中：
   - **输入教务处网址** (如: http://jw.djtu.edu.cn)
   - **登录系统** (输入用户名和密码)
   - **导航到学生列表页面** (找到学生管理/信息页面)

### 步骤3: 开始抓取
1. 完成浏览器操作后，返回终端
2. 终端会提示："确认是否开始抓取？ (y/n)"
3. 输入 `y` 或 `yes` 开始抓取
4. 输入 `n` 或 `no` 取消操作

### 步骤4: 查看结果
```bash
# 查看下载的照片
ls -la student_photos/

# 使用照片查看器浏览
python3 photo_viewer.py
```

## 🔧 常见问题解决

### 照片为空/下载失败
- **原因**: 会话未保持，需要传递浏览器cookies
- **解决**: 已修复，现在会自动获取浏览器cookies

### 无法找到学生列表
- **原因**: 页面结构不匹配
- **解决**: 使用调试工具分析页面
```bash
python3 debug_scraper.py
```

### 登录问题
- **建议**: 确保在浏览器中完成完整登录流程
- **检查**: 登录后确认能看到学生列表

## 🚀 快捷操作

### 一键启动
```bash
# 运行启动脚本
./start.bat
```

### 测试系统
```bash
# 运行系统测试
python3 test_system.py
```

## 📁 文件说明

- `student_photo_scraper_enhanced.py` - 主要抓取程序（已修复）
- `photo_viewer.py` - 照片查看器
- `debug_scraper.py` - 页面调试工具
- `start.bat` - 一键启动脚本
- `student_photos/` - 照片保存目录

## 💡 使用提示

1. **网络连接**: 确保网络连接正常
2. **浏览器**: 使用Chrome浏览器
3. **登录信息**: 提前准备好教务系统账号
4. **页面结构**: 熟悉学生列表页面的位置
5. **耐心等待**: 下载过程可能需要一些时间

## 🎉 成功标志
- 终端显示"✓ 已保存: 学生姓名.jpg (文件大小 bytes)"
- `student_photos/` 目录中有非空的照片文件
- 照片查看器能正常显示学生照片