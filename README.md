# 🎓 学生照片抽认卡系统 - 完整使用指南

> **现代化、智能化的学生照片抓取与管理工具**

## 🚨 重要提示：避免窗口切换问题

**核心解决方案：使用新建标签页方式，完全避免窗口切换困扰**

### 📱 推荐操作流程

```
启动程序 → Chrome弹出空白窗口 → 新建标签页操作 → 复制链接 → 回到原窗口粘贴 → 开始抓取
```

### 🎯 具体操作步骤

1. **启动程序后**，Chrome会弹出空白窗口（about:blank）
2. **不要在此窗口操作**，而是：
   - **Windows**: 按 `Ctrl + T` 新建标签页
   - **Mac**: 按 `Cmd + T` 新建标签页
3. **在新标签页完成所有操作**：
   - 输入教务处网址（如：http://jw.djtu.edu.cn）
   - 登录系统（输入账号密码）
   - 导航到学生列表页面
4. **复制学生列表页面完整URL**
5. **回到最初弹出的空白窗口**，粘贴URL并加载
6. **确认页面显示学生列表后**，在终端输入 `y` 开始抓取

## 🚀 快速开始

### 一键启动
```bash
# Windows
./start.bat

# Mac/Linux  
./start.sh
```

### 手动启动
```bash
# 安装依赖
pip install selenium requests pillow

# 运行增强版（推荐）
python3 student_photo_scraper_enhanced.py

# 使用照片查看器
python3 photo_viewer.py

# 使用Web抽认卡学习系统
python3 -m http.server 8000
# 然后访问 http://localhost:8000/flashcard.html
```

## 📋 完整使用流程

### 步骤1: 启动系统
运行脚本后，会自动打开Chrome浏览器（空白页面）

### 步骤2: 浏览器操作（关键步骤）

#### ✅ 推荐方法：新建标签页操作

1. **保持弹出窗口不变**（不要在此窗口操作）
2. **新建标签页**（Ctrl+T 或 Cmd+T）
3. **在新标签页完成所有操作**：
   - 输入教务处网址并登录
   - 导航到学生列表页面
4. **复制学生列表页面URL**
5. **回到最初弹出的窗口，粘贴URL**

### 步骤3: 确认抓取
完成浏览器操作后，终端会提示：
```
🎯 确认是否开始抓取？ (y/n): 
```
输入 `y` 开始自动抓取

### 步骤4: 查看结果
- 照片保存在 `student_photos/` 目录
- 使用照片查看器浏览：`python3 photo_viewer.py`
- 使用Web抽认卡学习：`python3 -m http.server 8000`

## 📁 项目结构

```
student_photo_system/
├── 🎯 核心程序
│   ├── student_photo_scraper_enhanced.py  # 增强版抓取程序（已修复窗口问题）
│   ├── student_photo_scraper.py           # 基础版抓取程序
│   ├── photo_viewer.py                    # 照片查看器
│   ├── config.py                         # 配置选择器
│   └── setup.py                          # 安装脚本
├── 🌐 Web应用
│   └── flashcard.html                    # 现代化抽认卡系统
├── 🚀 启动工具
│   ├── start.bat                         # Windows一键启动
│   └── start.sh                          # Mac/Linux一键启动
├── 📸 照片目录
│   └── student_photos/                   # 学生照片存储
├── 🛠️ 调试工具
│   ├── debug_window_issue.py             # 窗口问题调试
│   ├── test_window_switching.py          # 窗口测试
│   └── simple_window_scraper.py          # 简化测试
└── 📖 文档
    ├── README.md                         # 本完整指南
    └── project_summary.md                # 项目总结
```

## 🎨 功能特色

### 增强版特性（已修复所有已知问题）

- ✅ **窗口问题修复**: 支持新建标签页操作，避免窗口切换
- ✅ **自动ChromeDriver**: 智能匹配浏览器版本
- ✅ **多选择器支持**: 适应不同网页结构
- ✅ **会话保持**: 自动传递登录cookies
- ✅ **文件验证**: 空文件自动清理
- ✅ **实时进度**: 详细的操作状态提示
- ✅ **错误恢复**: 智能重试机制
- ✅ **调试信息**: 详细的查找过程显示

### 照片查看器功能

- 📱 **图形界面**: 基于Tkinter的现代化界面
- ⌨️ **快捷键支持**: 方向键切换，空格键随机
- 🖱️ **鼠标操作**: 按钮控制，直观易用
- 📊 **信息显示**: 显示学生姓名和照片信息

### 🌟 Web抽认卡功能（全新！）

**基于浏览器的现代化抽认卡学习系统**

- 🎯 **三行布局**: 导航按钮 | 显示答案 | 输入框
- 🎆 **烟花庆祝**: 答对触发全屏烟花效果
- 🔥 **连击系统**: 连续答对计数，右上角弹出提示
- 🏆 **终极成就**: 全部答对显示"全部答对！！！"
- 🎮 **智能逻辑**: 查看答案后当前题不计入连击
- 📱 **响应式设计**: 支持手机、平板、电脑全平台

#### Web抽认卡使用方法

1. **启动服务**
   ```bash
   python3 -m http.server 8000
   ```
2. **访问系统**
   打开浏览器访问：http://localhost:8000/flashcard.html
3. **使用流程**
   - 查看学生照片
   - 在输入框输入学生姓名
   - 按回车键或等待自动验证
   - 答对看烟花，答错重试

## 🔧 高级配置

### 自定义选择器

编辑 `config.py` 文件：

```python
# 学生姓名选择器
STUDENT_NAME_SELECTORS = [
    "a.student-name",
    ".student-info a",
    "tr td:nth-child(2) a"
]

# 照片选择器
STUDENT_PHOTO_SELECTORS = [
    "img.student-photo",
    ".avatar img",
    "img[src*='photo']"
]
```

### 系统要求

- **Python**: 3.6+
- **浏览器**: Chrome/Chromium
- **系统**: Windows/Mac/Linux
- **网络**: 稳定网络连接

## 🎯 使用场景

### 传统应用

- 👨‍🏫 **教师工具**: 制作学生名片、座位表
- 📚 **班级管理**: 学生通讯录、签到表
- 📝 **考试管理**: 考试座位安排、身份验证
- 🎓 **活动组织**: 活动签到、分组管理

### Web抽认卡应用

- 🧠 **记忆训练**: 通过游戏化方式记忆学生姓名
- 📱 **移动学习**: 手机、平板随时练习
- 🎯 **教学辅助**: 课堂点名、认识新同学
- 🏆 **成就激励**: 通过连击系统提高学习积极性

## 🆘 常见问题与解决

### 问题1: 程序卡住不动
**原因**: 窗口切换问题
**解决**: 使用新建标签页方式操作（详见上文）

### 问题2: 无法找到学生列表
**原因**: 页面结构不匹配
**解决**: 
```bash
# 使用调试工具分析页面
python3 debug_window_issue.py
```

### 问题3: 照片下载为空
**原因**: 会话未保持
**解决**: 已修复，程序会自动获取浏览器cookies

### 问题4: 登录问题
**解决**: 
- 确保在浏览器完成完整登录流程
- 使用新建标签页方式登录
- 确认登录后能看到学生列表

### 问题5: ChromeDriver问题
**解决**: 运行 `setup.py` 自动安装匹配版本

## 📋 成功标志

### 抓取成功
- 终端显示："✅ 学生XXX照片下载完成"
- `student_photos/` 目录中有非空的照片文件
- 文件大小正常（通常 > 10KB）

### Web抽认卡成功
- 访问 http://localhost:8000/flashcard.html 正常显示
- 照片能正常加载显示
- 输入姓名后能正确验证

## 💡 使用小贴士

1. **网络连接**: 确保网络连接正常
2. **浏览器**: 使用最新版Chrome浏览器
3. **登录信息**: 提前准备好教务系统账号密码
4. **页面结构**: 熟悉学生列表页面的位置
5. **耐心等待**: 下载过程可能需要一些时间
6. **调试模式**: 遇到问题先查看终端提示信息

## 🎉 完整验证流程

### 测试系统完整性

```bash
# 1. 测试程序能否正常启动
python3 student_photo_scraper_enhanced.py

# 2. 测试照片查看器
python3 photo_viewer.py

# 3. 测试Web抽认卡
python3 -m http.server 8000
# 访问 http://localhost:8000/flashcard.html

# 4. 测试调试工具（如需要）
python3 debug_window_issue.py
```

---

**🎓 学生照片抽认卡系统 - 让教学管理更高效！**

**核心优势**：通过新建标签页方式，完全避免窗口切换问题，确保程序稳定运行！
